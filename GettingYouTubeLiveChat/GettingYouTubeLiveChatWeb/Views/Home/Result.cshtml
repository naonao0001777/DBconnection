@model WebApplication1.Models.LiveChatModelList
@{
    ViewBag.Title = "Result";
}
<!DOCTYPE html>
<head>
    <meta name="viewport" content="width=device-width" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    @*<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.0/js/jquery.tablesorter.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.1/js/extras/jquery.metadata.min.js"></script>*@
    @*<script src="https://cdn.datatables.net/v/dt/dt-1.10.18/datatables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.16/js/dataTables.bootstrap.min.js"></script>*@

    <style type="text/css">
        .loading {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: rgba(0,0,0,.5);
            background-image: url(../../Content/img/Blocks-1s-293px.gif);
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-position: center center;
            background-size: 100px 100px;
            z-index: 9999;
        }
    </style>

</head>

<body>
    <h2>結果</h2>
    <h3>@ViewBag.Message</h3>

    <div>
        @Html.Encode(ViewData["postData"])を検索しました。
    </div>
    @if (!ViewBag.errFlg)
    {
        int count;
        <div class="table-responsive">
            <table border="1" class="table table-striped table-condensed" id="table">
                <thead>
                    <tr class="bg-primary">
                        <th>#No.</th>
                        <th>ユーザ名</th>
                        <th>コメント</th>
                    </tr>
                </thead>

                @for (int i = 0; i < Model.ChatList.Count(); i++)
                {
                    count = i + 1;
                    <tbody>
                        <tr>
                            <td>
                                @Html.DisplayFor(model => count)
                            </td>
                            <td>
                                @Html.DisplayFor(model => Model.ChatList[i].DspName)
                            </td>
                            <td>
                                @Html.DisplayFor(model => Model.ChatList[i].DspMessage)
                            </td>
                        </tr>
                    </tbody>
                }
            </table>
        </div>
    }
        <div>
            @using (Html.BeginForm("Result", "Home", null, FormMethod.Post))
            {
                <input type="hidden" name="param" value="@ViewData["postData"]">
                <input type="hidden" name="quantity" value="@ViewData["PostQuantity"]">
                @*<input type="hidden" name="count" value=@ViewBag.count>*@
                <input type="submit" value="再取得" name="param" id="button1" />
            }
            <button type="button" class="btn btn-primary w-auto mt-2" name="back" value="back" onclick="history.back()">
                戻る
            </button>
            <button type="button" class="btn btn-primary w-auto mt-2" name="forward" value="forward" onclick="history.forward()">
                次へ
            </button>
        </div>
    <div class="loading hide"></div>
</body>
<script type="text/javascript">
    // ローディング
    $(function buttonClick() {
        $('#button1').on('click', function () {
            $.ajax({
                url: './Result.cshtml',
                type: 'POST',
                beforeSend: function () {
                    $('.loading').removeClass('hide');
                }
            }).done(function () {
                $('.loading').addClass('hide');
            })
        }
        )
    })
    //// デフォルトの設定を変更
    //$.extend($.fn.dataTable.defaults, {
    //    language: {
    //        url: "http://cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Japanese.json"
    //    }
    //});
    //// ソート
    //$('#table').DataTable({
    //    lengthChange: false,
    //    info: false
    //});
</script>